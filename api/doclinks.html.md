# doclinks


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Create the module index

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L38"
target="_blank" style="float:right; font-size:smaller">source</a>

### patch_name

>  patch_name (o)

*If `o` is decorated with `patch` or `patch_to`, return its class-prefix
name*

``` python
def _test_patch(code): return patch_name(ast.parse(code).body[0])
s = "@patch\ndef _f(self:_T): ..."
test_eq('_T._f', _test_patch(s))
```

``` python
s = "@patch_to(_T)\ndef _g(self): ..."
test_eq('_T._g', _test_patch(s))
```

``` python
# Get all patched classes when patching with a union
s = "@patch\ndef _f(self:_T|_U|_V): ..."
test_eq(_test_patch(s), ['_T._f', '_U._f', '_V._f'])
```

``` python
# _build_modidx()
```

## Export a notebook

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L119"
target="_blank" style="float:right; font-size:smaller">source</a>

### nbglob

>  nbglob (path=None, skip_folder_re='^[_.]', file_glob='*.ipynb',
>              skip_file_re='^[_.]', key='nbs_path', as_path=False,
>              recursive:bool=True, symlinks:bool=True, file_re:str=None,
>              folder_re:str=None, skip_file_glob:str=None,
>              func:callable=<function join>, ret_folders:bool=False)

*Find all files in a directory matching an extension given a config
key.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>pathlib.Path | str</td>
<td></td>
<td>path to start searching</td>
</tr>
<tr>
<td>skip_folder_re</td>
<td>str</td>
<td>None</td>
<td>Skip folders matching regex,</td>
</tr>
<tr>
<td>file_glob</td>
<td>str</td>
<td>None</td>
<td>Only include files matching glob</td>
</tr>
<tr>
<td>skip_file_re</td>
<td>str</td>
<td>None</td>
<td>Skip files matching regex</td>
</tr>
<tr>
<td>key</td>
<td>str</td>
<td>nbs_path</td>
<td></td>
</tr>
<tr>
<td>as_path</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr>
<td>recursive</td>
<td>bool</td>
<td>True</td>
<td>search subfolders</td>
</tr>
<tr>
<td>symlinks</td>
<td>bool</td>
<td>True</td>
<td>follow symlinks?</td>
</tr>
<tr>
<td>file_re</td>
<td>str</td>
<td>None</td>
<td>Only include files matching regex</td>
</tr>
<tr>
<td>folder_re</td>
<td>str</td>
<td>None</td>
<td>Only enter folders matching regex</td>
</tr>
<tr>
<td>skip_file_glob</td>
<td>str</td>
<td>None</td>
<td>Skip files matching glob</td>
</tr>
<tr>
<td>func</td>
<td>callable</td>
<td>join</td>
<td>function to apply to each matched file</td>
</tr>
<tr>
<td>ret_folders</td>
<td>bool</td>
<td>False</td>
<td>return folders, not just files</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>L</strong></td>
<td></td>
<td><strong>Paths to matched files</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L128"
target="_blank" style="float:right; font-size:smaller">source</a>

### nbglob_cli

>  nbglob_cli (path:str=None, symlinks:bool=False, file_glob:str='*.ipynb',
>                  file_re:str=None, folder_re:str=None,
>                  skip_file_glob:str=None, skip_file_re:str='^[_.]',
>                  skip_folder_re:str='^[_.]')

*Find all files in a directory matching an extension given a config
key.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>None</td>
<td>Path to notebooks</td>
</tr>
<tr>
<td>symlinks</td>
<td>bool</td>
<td>False</td>
<td>Follow symlinks?</td>
</tr>
<tr>
<td>file_glob</td>
<td>str</td>
<td>*.ipynb</td>
<td>Only include files matching glob</td>
</tr>
<tr>
<td>file_re</td>
<td>str</td>
<td>None</td>
<td>Only include files matching regex</td>
</tr>
<tr>
<td>folder_re</td>
<td>str</td>
<td>None</td>
<td>Only enter folders matching regex</td>
</tr>
<tr>
<td>skip_file_glob</td>
<td>str</td>
<td>None</td>
<td>Skip files matching glob</td>
</tr>
<tr>
<td>skip_file_re</td>
<td>str</td>
<td>^[_.]</td>
<td>Skip files matching regex</td>
</tr>
<tr>
<td>skip_folder_re</td>
<td>str</td>
<td>^[_.]</td>
<td>Skip folders matching regex</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L144"
target="_blank" style="float:right; font-size:smaller">source</a>

### nbdev_export

>  nbdev_export (path:str=None,
>                    procs:<tokensnamingtheexportprocessorstouse.>='black_format
>                    ', symlinks:bool=False, file_glob:str='*.ipynb',
>                    file_re:str=None, folder_re:str=None,
>                    skip_file_glob:str=None, skip_file_re:str='^[_.]',
>                    skip_folder_re:str='^[_.]')

*Export notebooks in `path` to Python modules*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>None</td>
<td>Path or filename</td>
</tr>
<tr>
<td>procs</td>
<td>&lt;tokens naming the export processors to use.&gt;</td>
<td>black_format</td>
<td></td>
</tr>
<tr>
<td>symlinks</td>
<td>bool</td>
<td>False</td>
<td>Follow symlinks?</td>
</tr>
<tr>
<td>file_glob</td>
<td>str</td>
<td>*.ipynb</td>
<td>Only include files matching glob</td>
</tr>
<tr>
<td>file_re</td>
<td>str</td>
<td>None</td>
<td>Only include files matching regex</td>
</tr>
<tr>
<td>folder_re</td>
<td>str</td>
<td>None</td>
<td>Only enter folders matching regex</td>
</tr>
<tr>
<td>skip_file_glob</td>
<td>str</td>
<td>None</td>
<td>Skip files matching glob</td>
</tr>
<tr>
<td>skip_file_re</td>
<td>str</td>
<td>^[_.]</td>
<td>Skip files matching regex</td>
</tr>
<tr>
<td>skip_folder_re</td>
<td>str</td>
<td>^[_.]</td>
<td>Skip folders matching regex</td>
</tr>
</tbody>
</table>

`procs` names the optional processors you wish to run on the exported
cells of your notebook.

N.B.: the
[`black_format`](https://nbdev.fast.ai/api/export.html#black_format)
processor is passed in by default. But it is a no-op, unless
`black_formatting=True` is set in your `settings.ini` configuration. You
can omit it from
[`nbdev_export`](https://nbdev.fast.ai/api/doclinks.html#nbdev_export)
on the command line by passing in `--procs`.

## Construct Index

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L164"
target="_blank" style="float:right; font-size:smaller">source</a>

### create_index

>  create_index (url, pre=None)

*Create a documentation index from a sphinx inventory file at `url`,
with optional prefix `pre`*

``` python
url = 'https://docs.python.org/3'
syms = create_index(url)

for b in syms['builtins']:
    b = b.split('.')
    if len(b) != 2: continue
    b = b[1]
    assert b in bset

dict(list(syms['builtins'].items())[:10])
```

    {'builtins.bool': 'https://docs.python.org/3/library/functions.html#bool',
     'builtins.bytearray': 'https://docs.python.org/3/library/stdtypes.html#bytearray',
     'builtins.bytes': 'https://docs.python.org/3/library/stdtypes.html#bytes',
     'builtins.complex': 'https://docs.python.org/3/library/functions.html#complex',
     'builtins.dict': 'https://docs.python.org/3/library/stdtypes.html#dict',
     'builtins.float': 'https://docs.python.org/3/library/functions.html#float',
     'builtins.frozenset': 'https://docs.python.org/3/library/stdtypes.html#frozenset',
     'builtins.int': 'https://docs.python.org/3/library/functions.html#int',
     'builtins.list': 'https://docs.python.org/3/library/stdtypes.html#list',
     'builtins.memoryview': 'https://docs.python.org/3/library/stdtypes.html#memoryview'}

## Query the module index

Let’s test out our error handling when one of the entry points throws an
error:

``` python
# Create mock entry points
class BadEntryPoint:
    name = 'bad_entry'
    dist = type('Dist', (), {'key': 'bad_lib'})()
    def resolve(self): raise AttributeError("Simulated error")

class GoodEntryPoint:
    name = 'good_entry'
    dist = type('Dist', (), {'key': 'good_lib'})()
    def resolve(self): return {'syms': {}, 'settings': {}}
```

``` python
# Clear the cache before testing
_build_lookup_table.cache_clear()

# Patch iter_entry_points
with xpatch('pkg_resources.iter_entry_points', return_value=[BadEntryPoint(), GoodEntryPoint()]):
    entries, py_syms = _build_lookup_table()
    
    # Should only contain the good entry
    assert 'bad_entry' not in entries
    assert 'good_entry' in entries
    assert len(entries) == 1
entries
```

    {'good_entry': {'syms': {}, 'settings': {}}}

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L257"
target="_blank" style="float:right; font-size:smaller">source</a>

### NbdevLookup

>  NbdevLookup (strip_libs=None, incl_libs=None, skip_mods=None, ns=None)

*Mapping from symbol names to docs and source URLs*

Indexing returns a link to the symbol’s docs, along with the name of the
source file the source URL if available.

``` python
c = NbdevLookup()
c['nbdev.doclinks.NbdevLookup']
```

    ('https://nbdev.fast.ai/api/doclinks.html#nbdevlookup',
     'nbdev/doclinks.py',
     'https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py')

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L269"
target="_blank" style="float:right; font-size:smaller">source</a>

### NbdevLookup.doc

>  NbdevLookup.doc (sym)

*Link to docs for `sym`*

Here’s a test suite that verifies the error handling behavior:

``` python
c.doc('nbdev.doclinks.NbdevLookup')
```

    'https://nbdev.fast.ai/api/doclinks.html#nbdevlookup'

Symbol names are taken from libraries registered using the ‘nbdev’ entry
point. By default, all libraries with this entry point are searched, but
full symbol names (including module prefix) are required.

``` python
assert c.doc('numpy.array').startswith('http')
assert not c.doc('numpy.Array')
assert c.doc('NbdevLookup').endswith('#nbdevlookup')
assert not c.doc('array')
```

Pass `strip_libs` to list libraries which should be available without
requiring a module prefix.

``` python
c = NbdevLookup(strip_libs=('nbdev', 'nbdev_numpy'))
assert c.doc('array').startswith('http')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L274"
target="_blank" style="float:right; font-size:smaller">source</a>

### NbdevLookup.code

>  NbdevLookup.code (sym)

*Link to source code for `sym`*

``` python
NbdevLookup().code('fastcore.net.urlsend')
```

    'https://github.com/AnswerDotAI/fastcore/blob/master/fastcore/net.py#LNone'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/nbdev/blob/master/nbdev/doclinks.py#L292"
target="_blank" style="float:right; font-size:smaller">source</a>

### NbdevLookup.linkify

>  NbdevLookup.linkify (md)

```` python
md = """This is a link to `numpy.array` and to `array()` and to `get_config()` but not a link to `foobar`.
And not a link to <code>dict2nb</code>.

    This is not a link to `get_config`

```
This isn't a link to `get_config` either
```"""
````

``` python
print(NbdevLookup(('nbdev','numpy')).linkify(md))
```

    This is a link to [`numpy.array`](https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array) and to `array()` and to [`get_config()`](https://nbdev.fast.ai/api/config.html#get_config) but not a link to `foobar`.
    And not a link to <code>dict2nb</code>.

        This is not a link to `get_config`

    ```
    This isn't a link to `get_config` either
    ```

``` python
# Test code blocks
md = """```python
def foo():
    return `bar`
```"""
assert NbdevLookup().linkify(md) == md
```

``` python
# Test builtins
md = "`builtins.str.split`"
NbdevLookup().linkify(md)
```

    '[`builtins.str.split`](https://docs.python.org/3/library/stdtypes.html#str.split)'

``` python
# ... now with stripping
md = "`str.split` and `str`"
NbdevLookup('nbdev_stdlib').linkify(md)
```

    '[`str.split`](https://docs.python.org/3/library/stdtypes.html#str.split) and [`str`](https://docs.python.org/3/library/stdtypes.html#str)'

When there is a conflict, the linkification will apply in the order of
the stripped libraries and then by alphabetical order. For example,
`enumerate` is both a builtin and a function in the threading module.
However, since builtins comes first alphabetically, it will take
priority

``` python
md = "`enumerate`, `builtins.enumerate` and `threading.enumerate`"
NbdevLookup(('nbdev_stdlib')).linkify(md)
```

    '[`enumerate`](https://docs.python.org/3/library/functions.html#enumerate), [`builtins.enumerate`](https://docs.python.org/3/library/functions.html#enumerate) and [`threading.enumerate`](https://docs.python.org/3/library/threading.html#threading.enumerate)'

We can also take the `find()` function as another instance, it exists as
a standard library and in numpy. Therefore, depending on the order of
stripped libraries we pass, `find()` will link to either numpy or
standard library.

``` python
md = "`find()`"
NbdevLookup(('nbdev_numpy','nbdev_stdlib')).linkify(md)
```

    '[`find()`](https://numpy.org/doc/stable/reference/generated/numpy.char.find.html#numpy.char.find)'

``` python
md = "`find()`"
NbdevLookup(('nbdev_stdlib','nbdev_numpy')).linkify(md)
```

    '[`find()`](https://docs.python.org/3/library/gettext.html#gettext.find)'

You can also use NbdevLookup with import aliases like the following:

``` python
import numpy as np
```

``` python
NbdevLookup(ns=globals()).linkify('this is an aliased import link `np.array`')
```

    'this is an aliased import link [`np.array`](https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array)'
